/* ==========================================================
   FIN THEME — Ultra Defined (Finance Calendar v3)
   - niente HTML/JS da toccare
   - colori vivi, bordi evidenti, gerarchie chiare
   - contenitori più "intelligenti" sullo spazio disponibile
   ========================================================== */

/* ---------- BASE RESET ---------- */
* { box-sizing: border-box; }
html, body { height: 100%; }
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ---------- DESIGN TOKENS ---------- */
/* Usiamo !important perché nel tuo HTML alcune vars sono definite dopo.
   Qui vogliamo che il tema vinca. */
:root{
  /* layout */
  --rail-w: 92px !important;
  --explorer-w: clamp(280px, 22vw, 360px) !important;
  --insights-w: clamp(320px, 24vw, 420px) !important;
  --cmd-h: 124px !important;

  /* palette */
  --bg0: #070A12 !important;
  --bg1: #0B1020 !important;
  --bg2: #0E1630 !important;

  --panel: rgba(255,255,255,0.06) !important;
  --panel2: rgba(255,255,255,0.04) !important;
  --panel3: rgba(255,255,255,0.03) !important;

  --text: rgba(245,250,255,0.92) !important;
  --muted: rgba(200,215,255,0.62) !important;

  --border: rgba(180,200,255,0.16) !important;
  --border2: rgba(180,200,255,0.22) !important;

  --shadow: 0 18px 60px rgba(0,0,0,0.45);
  --shadow2: 0 8px 26px rgba(0,0,0,0.25);

  /* accenti */
  --accent: #4DA3FF !important;
  --accent2: #7C5CFF !important;
  --teal: #38E7C5 !important;
  --pink: #FF4D8D !important;
  --orange: #FFB84D !important;
  --green: #48FF9C !important;
  --red: #FF5C5C !important;
  --yellow: #FFD95C !important;

  /* area colors */
  --rail-grad: linear-gradient(180deg, rgba(77,163,255,0.18), rgba(124,92,255,0.10));
  --cmd-grad: linear-gradient(90deg, rgba(77,163,255,0.14), rgba(56,231,197,0.08), rgba(124,92,255,0.08));
  --explorer-grad: linear-gradient(180deg, rgba(56,231,197,0.10), rgba(255,255,255,0.02));
  --insights-grad: linear-gradient(180deg, rgba(255,184,77,0.10), rgba(255,255,255,0.02));

  /* soft layers usati nell’HTML */
  --soft: rgba(160,190,255,0.10) !important;
  --soft2: rgba(160,190,255,0.07) !important;
  --soft3: rgba(160,190,255,0.05) !important;
  --glow: rgba(77,163,255,0.42) !important;
}

/* Light mode automatico */
@media (prefers-color-scheme: light){
  :root{
    --bg0: #f5f7ff !important;
    --bg1: #eef3ff !important;
    --bg2: #e8eeff !important;

    --panel: rgba(20,30,60,0.06) !important;
    --panel2: rgba(20,30,60,0.04) !important;
    --panel3: rgba(20,30,60,0.03) !important;

    --text: rgba(10,16,30,0.92) !important;
    --muted: rgba(10,16,30,0.62) !important;

    --border: rgba(30,50,110,0.14) !important;
    --border2: rgba(30,50,110,0.18) !important;

    --shadow: 0 18px 50px rgba(20,30,60,0.12);
    --shadow2: 0 8px 20px rgba(20,30,60,0.10);
  }
}

/* ---------- PAGE BACKGROUND ---------- */
body{
  background:
    radial-gradient(1100px 720px at 18% 10%, rgba(77,163,255,0.16), transparent 55%),
    radial-gradient(900px 620px at 85% 0%, rgba(124,92,255,0.14), transparent 60%),
    radial-gradient(900px 700px at 70% 90%, rgba(56,231,197,0.10), transparent 55%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
  color: var(--text);
}

/* scrollbars */
*::-webkit-scrollbar{ width: 10px; height: 10px; }
*::-webkit-scrollbar-thumb{
  background: rgba(120,150,255,0.30);
  border: 2px solid rgba(0,0,0,0.20);
  border-radius: 999px;
}
*::-webkit-scrollbar-track{ background: rgba(0,0,0,0.15); }

/* ---------- LAYOUT OVERRIDES (spazio ottimizzato) ---------- */
.workspace{
  gap: 12px !important;
  padding: 12px !important;
  grid-template-rows: auto 1fr !important; /* topbar cresce */
}

/* ---------- RAIL ---------- */
.rail{
  background: var(--rail-grad) !important;
  border: 1px solid var(--border2) !important;
  box-shadow: var(--shadow2);
}
.rail__brand{
  background: rgba(0,0,0,0.10);
}
.rail-btn{
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.rail-btn:hover{
  transform: translateY(-1px);
  border-color: rgba(77,163,255,0.45);
  background: rgba(77,163,255,0.14);
}
.rail-btn[aria-pressed="true"]{
  border-color: rgba(77,163,255,0.65) !important;
  background: rgba(77,163,255,0.20) !important;
  box-shadow: 0 0 0 1px rgba(77,163,255,0.22) inset, 0 0 0 6px rgba(77,163,255,0.07);
}

/* ---------- TOPBAR / COMMAND BAR ---------- */
.commandbar{
  background: var(--cmd-grad) !important;
  border: 1px solid var(--border2) !important;
  min-height: var(--cmd-h) !important;
  height: auto !important;
  overflow: auto !important;
  padding: 14px 14px !important;
  box-shadow: var(--shadow2);
  align-items: flex-start !important;
}
.cmd-block, .cmd-search{
  border: 1px solid var(--border) !important;
  background: rgba(0,0,0,0.14) !important;
  backdrop-filter: blur(10px);
}
.cmd-search{
  min-width: clamp(220px, 26vw, 520px) !important;
}
.cmd-search input::placeholder{
  color: rgba(200,215,255,0.55);
}
.cmd-title{
  text-transform: uppercase;
  font-size: 12px;
  opacity: .92;
  letter-spacing: .9px;
}

/* ---------- EXPLORER ---------- */
.explorer{
  background: var(--explorer-grad) !important;
  border: 1px solid var(--border2) !important;
  box-shadow: var(--shadow2);
}
.explorer__head{
  background: rgba(0,0,0,0.14);
}

/* ---------- INSIGHTS ---------- */
.insights{
  background: var(--insights-grad) !important;
  border: 1px solid var(--border2) !important;
  box-shadow: var(--shadow2);
}
.insights__head{
  background: rgba(0,0,0,0.14);
}

/* ---------- MAIN ---------- */
.main{
  border: 1px solid var(--border2) !important;
  background:
    radial-gradient(900px 420px at 50% 0%, rgba(77,163,255,0.08), transparent 60%),
    rgba(255,255,255,0.02) !important;
  box-shadow: var(--shadow2);
}
.main__head{
  background: rgba(0,0,0,0.14);
}

/* ---------- PANELS ---------- */
.panel{
  background: var(--panel) !important;
  border: 1px solid var(--border) !important;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.03) inset;
}
.panel-title b{
  color: var(--text);
}
.help{
  color: var(--muted) !important;
}

/* ---------- BADGES ---------- */
.badge{
  border: 1px solid var(--border2) !important;
  background: rgba(0,0,0,0.18) !important;
}
.badge--ok{
  border-color: rgba(72,255,156,0.45) !important;
  background: rgba(72,255,156,0.12) !important;
}
.badge--warn{
  border-color: rgba(255,184,77,0.55) !important;
  background: rgba(255,184,77,0.14) !important;
}
.badge--bad{
  border-color: rgba(255,92,92,0.60) !important;
  background: rgba(255,92,92,0.14) !important;
}

/* ---------- CHIPS ---------- */
.chip{
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.chip:hover{
  transform: translateY(-1px);
  border-color: rgba(77,163,255,0.45);
}
.chip[aria-pressed="true"]{
  border-color: rgba(77,163,255,0.70) !important;
  background: rgba(77,163,255,0.18) !important;
}

/* ---------- BUTTONS ---------- */
.btn{
  border: 1px solid var(--border) !important;
  background: rgba(0,0,0,0.18);
  color: var(--text);
  font-weight: 900;
  padding: 10px 12px;
  border-radius: 14px;
  cursor: pointer;
  transition: transform .12s ease, border-color .12s ease, background .12s ease, box-shadow .12s ease;
  user-select: none;
}
.btn:hover{
  transform: translateY(-1px);
  border-color: rgba(77,163,255,0.55) !important;
  box-shadow: 0 0 0 5px rgba(77,163,255,0.10);
}
.btn--ghost{
  background: rgba(255,255,255,0.03);
}
.btn--icon{
  width: 36px;
  height: 36px;
  padding: 0;
  display:inline-grid;
  place-items:center;
}
.btn--primary{
  border-color: rgba(77,163,255,0.65) !important;
  background: linear-gradient(180deg, rgba(77,163,255,0.35), rgba(77,163,255,0.18));
  box-shadow: 0 0 0 6px rgba(77,163,255,0.08);
}
.btn--seg{
  background: rgba(0,0,0,0.16);
}
.btn--seg[aria-pressed="true"]{
  border-color: rgba(77,163,255,0.70) !important;
  background: rgba(77,163,255,0.20);
  box-shadow: 0 0 0 6px rgba(77,163,255,0.08);
}
.btn--tiny{
  padding: 6px 10px !important;
  border-radius: 12px !important;
  font-size: 12px !important;
}

/* ---------- EMPTY STATE ---------- */
.empty-state{
  border: 1px dashed rgba(180,200,255,0.30) !important;
  background: rgba(0,0,0,0.16) !important;
  color: var(--muted) !important;
}

/* ==========================================================
   CALENDAR VISUAL SYSTEM (qui nasce la “vita”)
   ========================================================== */

.calendar{
  width: 100%;
}

/* month grid */
.calendar-grid--month{
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.dow-row{
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
}
.dow-cell{
  padding: 10px 10px;
  border-radius: 14px;
  border: 1px solid rgba(180,200,255,0.14);
  background: rgba(0,0,0,0.14);
  color: rgba(200,215,255,0.80);
  font-weight: 1000;
  text-transform: uppercase;
  letter-spacing: .8px;
  font-size: 12px;
}
.week-row{
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
  min-height: 160px;
}

.day-cell{
  border: 1px solid rgba(180,200,255,0.16);
  background: rgba(0,0,0,0.16);
  border-radius: 18px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset;
}
.day-cell.is-today{
  border-color: rgba(77,163,255,0.65);
  box-shadow: 0 0 0 1px rgba(77,163,255,0.20) inset, 0 0 0 10px rgba(77,163,255,0.08);
}
.day-cell.is-weekend{
  background: rgba(124,92,255,0.10);
}
.day-cell.is-out-month{
  opacity: .55;
}

.day-cell__header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding: 10px 10px;
  background: rgba(255,255,255,0.03);
  border-bottom: 1px solid rgba(180,200,255,0.10);
}
.day-cell__num{
  font-weight: 1000;
  font-size: 14px;
}
.btn--cell-add{
  width: 30px !important;
  height: 30px !important;
  border-radius: 12px !important;
  background: rgba(77,163,255,0.15) !important;
  border-color: rgba(77,163,255,0.40) !important;
}
.day-cell__body{
  padding: 10px;
  display:flex;
  flex-direction:column;
  gap: 8px;
  overflow:auto;
  flex:1;
}

/* week/day view */
.calendar-grid--week{
  display:grid;
  grid-template-columns: repeat(7, minmax(220px, 1fr));
  gap: 10px;
}
.day-col{
  border: 1px solid rgba(180,200,255,0.16);
  background: rgba(0,0,0,0.16);
  border-radius: 18px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-height: 380px;
}
.day-col.is-today{
  border-color: rgba(77,163,255,0.65);
  box-shadow: 0 0 0 12px rgba(77,163,255,0.08);
}
.day-col__header{
  padding: 10px;
  border-bottom:1px solid rgba(180,200,255,0.10);
  background: rgba(255,255,255,0.03);
  display:flex;
  justify-content:space-between;
  align-items:baseline;
}
.day-col__dow{
  font-weight:1000;
  letter-spacing:.3px;
}
.day-col__date{
  color: var(--muted);
  font-weight:900;
}
.day-col__body{
  padding: 10px;
  display:flex;
  flex-direction:column;
  gap: 8px;
  overflow:auto;
  flex:1;
}

/* agenda view */
.view--agenda .panel{
  background: rgba(0,0,0,0.16) !important;
}

/* year view */
.year-grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}
.month-mini{
  border: 1px solid rgba(180,200,255,0.16);
  background: rgba(0,0,0,0.16);
  border-radius: 18px;
  padding: 12px;
  cursor:pointer;
  transition: transform .12s ease, border-color .12s ease;
}
.month-mini:hover{
  transform: translateY(-1px);
  border-color: rgba(77,163,255,0.45);
}
.month-mini__header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.month-mini__title{
  font-weight:1000;
  text-transform:capitalize;
}
.month-mini__count{
  color: var(--muted);
  font-weight:900;
}

/* ==========================================================
   EVENT BLOCKS — colore vero per tipo (finalmente leggibile)
   ========================================================== */

.event-block{
  width: 100%;
  border-radius: 16px;
  border: 1px solid rgba(180,200,255,0.16);
  background: rgba(255,255,255,0.03);
  padding: 10px;
  text-align:left;
  cursor:pointer;
  transition: transform .12s ease, border-color .12s ease, background .12s ease;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset;
  position: relative;
}
.event-block:hover{
  transform: translateY(-1px);
  border-color: rgba(77,163,255,0.50);
  background: rgba(77,163,255,0.10);
}
.event-block__top{
  display:flex;
  justify-content:space-between;
  gap:10px;
  align-items:flex-start;
}
.event-block__title{
  font-weight:1000;
  letter-spacing:.2px;
  font-size: 13px;
  line-height:1.15;
}
.event-block__pin{
  color: var(--yellow);
  font-weight:1000;
}
.event-block__meta{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:6px;
  color: var(--muted);
  font-weight:800;
  font-size: 12px;
}
.event-block__amount{
  margin-top:6px;
  font-weight: 1000;
  font-size: 13px;
}

/* Color stripes per tipo */
.event-block--type-income{
  border-left: 6px solid rgba(72,255,156,0.85);
  background: linear-gradient(90deg, rgba(72,255,156,0.12), rgba(255,255,255,0.02));
}
.event-block--type-expense{
  border-left: 6px solid rgba(255,92,92,0.85);
  background: linear-gradient(90deg, rgba(255,92,92,0.12), rgba(255,255,255,0.02));
}
.event-block--type-transfer{
  border-left: 6px solid rgba(77,163,255,0.90);
  background: linear-gradient(90deg, rgba(77,163,255,0.14), rgba(255,255,255,0.02));
}
.event-block--type-other{
  border-left: 6px solid rgba(124,92,255,0.85);
  background: linear-gradient(90deg, rgba(124,92,255,0.12), rgba(255,255,255,0.02));
}

/* compact density */
.calendar[data-density="compact"] .event-block{
  padding: 8px;
  border-radius: 14px;
}
.calendar[data-density="compact"] .event-block__meta{
  margin-top:4px;
}

/* ==========================================================
   DRAWER + MODAL (mancavano → ora sono "premium")
   ========================================================== */

.drawer{
  position: fixed;
  right: 14px;
  top: 14px;
  bottom: 14px;
  width: min(520px, 92vw);
  background: rgba(0,0,0,0.55);
  border: 1px solid rgba(180,200,255,0.20);
  border-radius: 20px;
  overflow:hidden;
  box-shadow: var(--shadow);
  transform: translateX(0);
  display:flex;
  flex-direction:column;
  backdrop-filter: blur(14px);
}
.drawer[aria-hidden="true"]{
  display:none;
}
.drawer__header{
  padding: 14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom: 1px solid rgba(180,200,255,0.14);
  background: rgba(255,255,255,0.04);
}
.drawer__body{
  padding: 14px;
  overflow:auto;
  display:flex;
  flex-direction:column;
  gap: 12px;
}
.drawer__actions{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.drawer-scrim{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display:none;
}

/* dialog modal */
dialog#eventModal{
  width: min(640px, 92vw);
  border-radius: 20px;
  border: 1px solid rgba(180,200,255,0.22);
  background: rgba(0,0,0,0.65);
  color: var(--text);
  box-shadow: var(--shadow);
  padding: 0;
  overflow:hidden;
  backdrop-filter: blur(16px);
}
dialog#eventModal::backdrop{
  background: rgba(0,0,0,0.60);
}
.modal__header, .modal__footer{
  padding: 14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  background: rgba(255,255,255,0.04);
}
.modal__header{
  border-bottom: 1px solid rgba(180,200,255,0.14);
}
.modal__footer{
  border-top: 1px solid rgba(180,200,255,0.14);
}
#eventForm{
  padding: 14px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.form-field{
  display:flex;
  flex-direction:column;
  gap: 6px;
}
.label{
  font-size: 12px;
  font-weight: 1000;
  color: rgba(200,215,255,0.72);
}
#eventForm input, #eventForm select, #eventForm textarea{
  border: 1px solid rgba(180,200,255,0.18);
  background: rgba(255,255,255,0.04);
  color: var(--text);
  border-radius: 14px;
  padding: 10px;
  font-weight: 900;
  outline: none;
}
#eventForm textarea{
  min-height: 100px;
  resize: vertical;
}

/* ==========================================================
   MOVEMENTS TABLE — più leggibile
   ========================================================== */

.movements{
  box-shadow: 0 0 0 1px rgba(255,255,255,0.03) inset;
}
.movements tr:hover td{
  background: rgba(77,163,255,0.08);
}
.amt-pos{ color: rgba(72,255,156,0.95); }
.amt-neg{ color: rgba(255,92,92,0.95); }
/* ================================
   FIX: Event Modal (dialog) text colors on dark theme
   (no HTML changes)
================================== */

#eventModal{
  color: var(--text);
  background: rgba(18,18,18,0.96);
  border: 1px solid rgba(128,128,128,0.20);
  border-radius: 18px;
  box-shadow: 0 20px 80px rgba(0,0,0,0.55);
}

/* backdrop più “night mode” */
#eventModal::backdrop{
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(6px);
}

/* Labels e testi del form */
#eventModal label,
#eventModal .label{
  color: var(--muted);
}

/* Input / Select / Textarea in modal */
#eventModal input,
#eventModal select,
#eventModal textarea{
  color: var(--text);
  background: rgba(128,128,128,0.06);
  border: 1px solid rgba(128,128,128,0.22);
}

/* Placeholder più leggibile */
#eventModal input::placeholder,
#eventModal textarea::placeholder{
  color: rgba(220,220,220,0.45);
}

/* Help text */
#eventModal .help,
#eventModal small{
  color: var(--muted);
}

/* Dropdown: alcune UI rendono le option scure/illeggibili */
#eventModal option{
  background: rgba(18,18,18,0.98);
  color: var(--text);
}

/* Focus più visibile */
#eventModal input:focus,
#eventModal select:focus,
#eventModal textarea:focus{
  border-color: rgba(80,160,255,0.55);
  box-shadow: 0 0 0 3px rgba(80,160,255,0.15);
  outline: none;
}

/* ==========================================================
   RESPONSIVE
   ========================================================== */

@media (max-width: 1220px){
  .year-grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 980px){
  dialog#eventModal{
    width: min(720px, 96vw);
  }
  #eventForm{
    grid-template-columns: 1fr;
  }
}
