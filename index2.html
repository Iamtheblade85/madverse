<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dwarfs Cave</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles_goblin_game.css" />
  <script>
    /* opzionale: imposta BASE_URL prima di app.js se diverso dal default */
    window.BASE_URL = window.BASE_URL || "https://iamemanuele.pythonanywhere.com";
    /* opzionale: memorizza userData (wax_account, userId, usx_token) in localStorage o window.userData */
  </script>
</head>
<body>
  <main id="goblin-content" class="cv-wrap" aria-live="polite">
    <section id="expedition-summary-block" class="cv-row-wrap">
      <div class="cv-col-left">
        <h3 class="cv-title">‚õèÔ∏è Global Expeditions in Progress</h3>
        <div id="cv-toast-host" class="cv-toast-host" role="status" aria-live="polite"></div>
        <div id="cv-video-or-canvas" class="cv-canvas-wrap">
          <canvas id="caveCanvas" class="cv-canvas" aria-label="Cave canvas"></canvas>
        </div>
      </div>

      <div class="cv-col-right">
        <!-- LIVE EXPEDITIONS -->
        <div id="cv-global-list" class="cv-card">
          <div class="cv-card-head">
            <h4 class="cv-card-title cyan">üåç Live Expeditions (in progress)</h4>
            <span class="cv-chip cyan-outline" title="Aggiornamento automatico">auto refresh</span>
          </div>
          <div id="cv-global-cards" class="cv-cards"></div>
        </div>

        <!-- RECENT RESULTS -->
        <div id="cv-recent-list" class="cv-card amber">
          <div class="cv-card-head">
            <h4 class="cv-card-title amber">‚õèÔ∏è Latest Expedition Results</h4>
            <span class="cv-chip amber-outline">last 10</span>
          </div>
          <div id="cv-recent-grid" class="cv-cards"></div>
          <div id="cv-recent-empty" class="cv-empty" hidden>Nessun risultato.</div>
        </div>

        <!-- BONUS CHESTS -->
        <div id="cv-bonus-list" class="cv-card green">
          <div class="cv-card-head">
            <h4 class="cv-card-title green">üéÅ Latest Chest Rewards</h4>
            <span class="cv-chip green-outline">live</span>
          </div>
          <div id="cv-bonus-grid" class="cv-bonus-grid"></div>
        </div>

        <!-- TRY PERK DROP -->
        <div class="cv-cta">
          <p class="cv-cta-note">‚è±Ô∏è <strong>Perk attempt:</strong> 1 ogni <strong>10 min</strong> per WAX account ¬∑ <span class="muted">chance ~50% di spawn</span></p>
          <button id="cv-chest-btn" class="cv-btn cv-btn-perk" aria-label="Try to trigger a perk and drop a chest">
            üéÅ Try a Perk Drop
          </button>
          <div class="cv-cta-hint">Cooldown gestito dal server.</div>
        </div>
      </div>
    </section>

    <!-- SELEZIONE GOBLIN -->
    <section class="cv-section">
      <h3 class="cv-title">üéí Seleziona i tuoi goblin e prepara la spedizione</h3>

      <!-- Toolbar filtri -->
      <div class="cv-toolbar">
        <input id="cv-search" class="cv-input" placeholder="Search name or ID‚Ä¶" />
        <select id="cv-rarity" class="cv-select">
          <option value="">All Rarities</option>
          <option>Common</option><option>Uncommon</option><option>Rare</option>
          <option>Epic</option><option>Legendary</option><option>Mythic</option>
        </select>
        <div class="cv-range">
          <label for="cv-power">Min Power</label>
          <input id="cv-power" type="range" min="0" max="100" step="1" value="0" />
          <span id="cv-power-val" class="cv-range-val">0</span>
        </div>

        <div id="cv-sort-segment" class="cv-segment" role="tablist" aria-label="Sort">
          <button class="cv-seg-btn" data-sort="rarity" role="tab" aria-selected="true">Rarity</button>
          <button class="cv-seg-btn" data-sort="level" role="tab">Level</button>
          <button class="cv-seg-btn" data-sort="daily_power" role="tab">Power</button>
        </div>

        <div id="cv-duration-segment" class="cv-segment" role="tablist" aria-label="Duration">
          <button class="cv-seg-btn" data-dur="10m" role="tab">10m <small>2.0√ó</small></button>
          <button class="cv-seg-btn" data-dur="30m" role="tab">30m <small>1.3√ó</small></button>
          <button class="cv-seg-btn is-active" data-dur="1h" role="tab" aria-selected="true">1h <small>1.0√ó</small></button>
          <button class="cv-seg-btn" data-dur="6h" role="tab">6h <small>0.7√ó</small></button>
          <button class="cv-seg-btn" data-dur="24h" role="tab">24h <small>0.4√ó</small></button>
        </div>

        <button class="cv-btn" id="cv-select-50">‚úÖ First 50</button>
        <button class="cv-btn" id="cv-select-best">üèÜ Best 50</button>
        <button class="cv-btn" id="cv-deselect">‚ùå Clear</button>
      </div>

      <div id="cv-summary" class="cv-card sticky"></div>
      <div id="cv-active-filters" class="cv-active-filters"></div>

      <div id="cv-goblin-list" class="cv-goblin-grid"></div>
    </section>
  </main>

  <script src="./app_game.js" defer></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof window.renderDwarfsCave === "function") window.renderDwarfsCave();
    });
  </script>
</body>
</html>
